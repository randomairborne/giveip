<!DOCTYPE html>
<html>

<head>
    <title id="title">What's my IP?</title>
    <style>
        h1 {
            font-size: 32px;
            font-size: 3vw;
            height: 100%;
            width: 100%;
            display: flex;
            position: fixed;
            align-items: center;
            justify-content: center;
            font-family: 'Helvetica', sans-serif;
        }

        .stack {
            display: inline;
        }
    </style>
    <noscript>
         <meta http-equiv="refresh" content="5; URL=/raw">
    </noscript>
</head>

<body onload="onLoad()">
    <h1>
        <div class="stack">
            <div id="ip4txt" style="display: none;">Your public IPv4 is:&nbsp;<code id="ip4">(none)</code></div>
            <div id="ip6txt" style="display: none;">Your public IPv6 is:&nbsp;<code id="ip6">(none)</code></div>
        </div>
    </h1>
    <script>
        async function onLoad() {
            const ip4 = document.getElementById("ip4");
            const ip6 = document.getElementById("ip6");
            const ip4txt = document.getElementById("ip4txt");
            const ip6txt = document.getElementById("ip6txt");
            let didSucceed = false;
            let v4 = await fetch("https://v4.giveip.io/raw").then(req => req.text().catch(failed => { console.log("Request failed:" + failed) }));
            if (v4 !== undefined) {
                ip4.innerText = v4;
                ip4txt.style.display = null;
                didSucceed = true;
            }
            document.getElementById("title").innerText = `Your IP is ${v4}`;
            let v6 = await fetch("https://v6.giveip.io/raw").then(req => req.text()).catch(failed => { console.log("Request failed:" + failed) });
            if (v6 !== undefined) {
                ip6.innerText = v6;
                ip6txt.style.display = null;
                didSucceed = true;
            }
            if (!didSucceed) {
                window.location.href = "https://giveip.io/raw";
            }
        }
    </script>

</html>
